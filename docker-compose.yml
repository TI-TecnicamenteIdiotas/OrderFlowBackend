version: '3.9'

services:
  nimbleflow.aspnetcore:
    container_name: nimbleflow.aspnetcore
    image: ${CONTAINER_REGISTRY}:${TAG:-latest}
    environment:
      - AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
      - AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
      - AWS_REGION=${AWS_REGION}
      - SQL_DATABASE_SERVER=${SQL_DATABASE_SERVER}
      - SQL_DATABASE_PORT=${SQL_DATABASE_PORT}
      - SQL_DATABASE_DATABASE=${SQL_DATABASE_DATABASE}
      - SQL_DATABASE_USER=${SQL_DATABASE_USER}
      - SQL_DATABASE_PASSWORD=${SQL_DATABASE_PASSWORD}
      - AWS_S3_SERVICE_URL=${AWS_S3_SERVICE_URL}
      - AWS_S3_BUCKET_NAME=${AWS_S3_BUCKET_NAME}
    ports:
      - "10504:80"

  nimbleflow.java:
    container_name: nimbleflow.java
    image: ${CONTAINER_REGISTRY}:${TAG:-latest}
    environment:
      - AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
      - AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
      - AWS_REGION=${AWS_REGION}
      - NO_SQL_DATABASE_PATH=${NO_SQL_DATABASE_PATH}
      - NIMBLEFLOW_JAVA_API_USERNAME=${NIMBLEFLOW_JAVA_API_USERNAME}
      - NIMBLEFLOW_JAVA_API_PASSWORD=${NIMBLEFLOW_JAVA_API_PASSWORD}
      - NIMBLEFLOW_JAVA_API_INTEGRATION_TOKEN=${NIMBLEFLOW_JAVA_API_INTEGRATION_TOKEN}
      - NIMBLEFLOW_JAVA_API_JWT_SIGNING_KEY=${NIMBLEFLOW_JAVA_API_JWT_SIGNING_KEY}
    ports:
      - "10505:8080"